<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BoQ Generator — Rooms & Dimensions</title>
  <style>
    :root {
      --forest:#0b6b3a;
      --forest-dark:#062e1a;
      --forest-light:#14532d;
      --accent:#16a34a;
    }

    body {
      margin:0;
      font-family: Inter, sans-serif;
      background: var(--forest-dark);
      color:#f5f5f5;
      font-size:16px;
      line-height:1.5;
    }

    .app {
      display:flex;
      justify-content:center;
      align-items:center;
      min-height:100vh;
      padding:20px;
    }

    .card {
      max-width:700px;
      width:100%;
      background: var(--forest-light);
      border-radius:14px;
      padding:24px;
      box-shadow:0 6px 20px rgba(0,0,0,0.4);
    }

    h1 {
      margin:0 0 12px;
      font-size:24px;
      color:#fff;
    }

    p.lead {
      color:#cbd5c0;
      margin-bottom:20px;
    }

    label {
      display:block;
      margin-bottom:6px;
      font-size:15px;
      font-weight:500;
      color:#e0e0e0;
    }

    input {
      width:100%;
      padding:10px;
      border-radius:8px;
      border:1px solid #1f3d2c;
      background: var(--forest-dark);
      color:#fff;
      margin-bottom:12px;
      font-size:15px;
    }

    .room {
      border:1px solid rgba(255,255,255,0.1);
      padding:12px;
      border-radius:10px;
      margin-bottom:14px;
      background:rgba(0,0,0,0.2);
    }

    .footer-fixed {
      position:fixed;
      bottom:0;
      left:0;
      right:0;
      background: var(--forest-dark);
      padding:12px 20px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      border-top:1px solid rgba(255,255,255,0.08);
    }

    button {
      background: var(--accent);
      border:none;
      padding:10px 18px;
      border-radius:8px;
      font-weight:600;
      font-size:15px;
      color:#fff;
      cursor:pointer;
      transition: background .2s;
    }
    button:hover { background:#15803d; }
    button.secondary { background:#374151; }
    button.secondary:hover { background:#4b5563; }

    .toast {
      position:fixed;
      right:20px;
      bottom:90px;
      background: var(--forest);
      padding:14px 16px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,0.15);
      color:#e6ffe9;
      display:none;
      font-size:14px;
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="card">
      <h1>Step 2 — Rooms & Dimensions</h1>
      <p class="lead">Enter the rooms and their dimensions (in meters).</p>

      <div id="roomsContainer"></div>
      <button type="button" id="addRoomBtn" class="secondary">+ Add Room</button>
    </div>
  </div>

  <div class="footer-fixed">
    <button id="backBtn">Back</button>
    <button id="nextBtn">Proceed to Page 3</button>
  </div>

  <div id="toast" class="toast"></div>

  <script>
    const roomsContainer = document.getElementById('roomsContainer');
    const addRoomBtn = document.getElementById('addRoomBtn');
    const nextBtn = document.getElementById('nextBtn');
    const backBtn = document.getElementById('backBtn');
    const toast = document.getElementById('toast');

    // Load existing project data
    let projectData = JSON.parse(localStorage.getItem('boq_project') || '{}');
    if (!projectData.projectName) {
      alert("No project data found. Redirecting to setup.");
      window.location.href = "index.html"; // your page1 filename
    }
    if (!projectData.rooms) projectData.rooms = [];

    function showToast(msg){
      toast.textContent = msg;
      toast.style.display = 'block';
      setTimeout(()=>toast.style.display='none',2000);
    }

    function createRoomElement(room={name:"", length:"", width:"", height:""}) {
      const div = document.createElement('div');
      div.className = "room";
      div.innerHTML = `
        <label>Room name</label>
        <input type="text" class="room-name" value="${room.name}" placeholder="e.g. Living Room" required />
        <label>Length (m)</label>
        <input type="number" step="0.01" class="room-length" value="${room.length}" required />
        <label>Width (m)</label>
        <input type="number" step="0.01" class="room-width" value="${room.width}" required />
        <label>Height (m)</label>
        <input type="number" step="0.01" class="room-height" value="${room.height}" required />
      `;
      roomsContainer.appendChild(div);
    }

    // Load existing rooms if any
    projectData.rooms.forEach(r => createRoomElement(r));

    // Add room button
    addRoomBtn.addEventListener('click', () => {
      createRoomElement();
    });

    // Save & proceed
    nextBtn.addEventListener('click', () => {
      const roomEls = document.querySelectorAll('.room');
      let rooms = [];
      roomEls.forEach(el => {
        rooms.push({
          name: el.querySelector('.room-name').value.trim(),
          length: parseFloat(el.querySelector('.room-length').value) || 0,
          width: parseFloat(el.querySelector('.room-width').value) || 0,
          height: parseFloat(el.querySelector('.room-height').value) || 0
        });
      });
      projectData.rooms = rooms;
      localStorage.setItem('boq_project', JSON.stringify(projectData));
      showToast("Rooms saved. Proceeding...");
      setTimeout(()=> window.location.href="page3.html", 1000);
    });

    backBtn.addEventListener('click', () => {
      window.location.href = "index.html"; // page1 filename
    });
  </script>
</body>
</html>
